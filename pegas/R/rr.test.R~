## rr.test.R (2011-07-11)

##   Tajima's Relative Rate Test of Molecular Clock

## Copyright 2011 Alastair Potts

## This file is part of the R-package `pegas'.
## See the file ../COPYING for licensing issues.

rr.test <- function(sample.one, sample.two, outgroup)
{
    l <- seg.sites(rbind(sample.one, outgroup))
    m <- seg.sites(rbind(sample.two, outgroup))
    m1 <- length(l[!l %in% m])
    m2 <- length(m[!m %in% l])
    CHI <- (m1 - m2)^2 / (m1 + m2)
    PVAL <- 1 - pchisq(CHI, df = 1)
    list(Chi = CHI, Pval = PVAL)
}
